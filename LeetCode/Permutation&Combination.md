## 排列组合（Permutation and Combination）

#### 加法原理

- 完成一个工程可以有 $n$ 类办法， $a_i(1 \leq i \leq n)$ 代表第 $n$ 类方法的数目。那么完成这件事共有 $S=a_1+a_2+ \cdots + a_n$ 种不同的方法。

#### 乘法原理

- 完成一个工程需要分 $n$ 个步骤，$a_i(1 \leq i \leq n)$ 代表第 $i$ 个步骤的不同方法数目。那么完成这件事共有 $S=a_1 \times a_2 \times \cdots \times a_n$ 种不同的方法。

#### 排列数

- 从 $n$ 个不同元素中，任取 $m$ （ $m \leq n$ ， $m$ 与 $n$ 均为自然数，下同）个元素按照一定的顺序**排成一列**，叫做从 $n$ 个不同元素中取出 $m$ 个元素的一个排列，所有排列的个数，叫排列数，用符号 $A_n^m$ （或者是 $P_n^m$ ）表示。**排列的计算公式**如下：
  $$
  A_n^m = n (n-1) (n-2) \cdots (n-m+1)= \frac{n!}{(n-m)!}
  $$

- **环排列**，在 $n$ 个元素中取出 $m$ 个元素排成一个环（考虑**位移相似**），其计算公式如下：
  $$
  Q_n^m = \frac{A_n^m}{m} = \frac{n!}{m \cdot (n-m)!}
  $$
  进一步考虑**顺时针**和**逆时针**无差别，那么公式如下：
  $$
  {Q'}_n^m = \frac{A_n^m}{2m} = \frac{n!}{2m \cdot (n-m)!}
  $$

- **全排列**：
  $$
  A_n^m = n!
  $$

#### 组合数

- 从 $n$ 个不同元素中，任取 $m$ （ $m \leq n$ ， $m$ 与 $n$ 均为自然数，下同）个元素组成一个集合，叫做从 $n$ 个不同元素中取出 $m$ 个元素的一个组合，所有组合的个数，叫组合数，用符号 $C_n^m$ 表示。**组合的计算公式**如下：
  $$
  C_n^m = \frac{A_n^m}{m!} = \frac{n!}{m!(n-m)!} = {n \choose m}
  $$

#### 插板法

- **插板法**（`Stars and bars`）是用于求一类给相同元素分组的方案数的一种技巧，也可以用于求一类线性不定方程的解的组数。

> **问题一**：现有 $n$ 个完全相同的元素，要求将其分为 $k$ 组，保证每组至少有一个元素，一共有多少种分法？

- 考虑拿 $k-1$ 块板子插入到 $n$ 个元素两两形成的 $n-1$ 个空里面。因为元素是完全相同的，所以答案就是 ：
  $$
  {n-1 \choose k-1}
  $$

- 本质上是求 $x_1 + x_2 + \cdots + x_k = n$ 的正整数解的组数。

> **问题二**：现有 $n$ 个完全相同的元素，要求将其分为 $k$ 组，每组允许为空，一共有多少种分法？

- 显然此时没法直接插板了，因为有可能出现很多块板子插到一个空里面的情况。我们考虑创造条件转化成有限制的问题一，先借 $k$ 个元素过来，在这 $n+k$ 个元素形成的 $n+k-1$ 个空里面插板，答案为：
  $$
  {n+k-1 \choose k-1} = {n+k-1 \choose n}
  $$

- 本质上是求 $x_1 + x_2 + \cdots + x_k = n$ 的非负整数解的组数。

> **问题三**：现有 $n$ 个完全相同的元素，要求将其分为 $k$ 组，第 $i$ 组至少分到 $a_i$ 个，一共有多少种分法？

- 类比问题二，先借 $\sum a_i$ 个元素过来，也就是令 $x_i' = x_i - a_i$ ，那么：
  $$
  \begin{align}
  (x_1' + a_1)+(x_2' + a_2) + \cdots + (x_k' + a_k) &= n \\
  x_1' + x_2' + \cdots + x_k' &= n - a_1 - a_2 - \cdots - a_k \\
  x_1' + x_2' + \cdots + x_k' &= n- \sum a_i
  \end{align}
  $$
  所以，用插板法得到答案：
  $$
  {n + \sum a_i -1 \choose n}
  $$

#### 不相邻的排列

> **问题**：现有 $n$ 个连续的自然数，要求选择其中 $k$ 个，保证两两都不想邻，一共有多少种选法？

$$
{n-k+1 \choose k}
$$

#### 二项式定理

- 从常见的公式：
  $$
  (a+b)^n = \sum_{i=0}^{n} {n \choose i} a^{n-i}b^{i}
  $$
  当等式两边同乘 $(a+b)$ ，则可以得到：
  $$
  {n \choose k} + {n \choose k-1} = {n+1 \choose k}
  $$

#### 多重集

- **多重集**是指包含重复元素的广义集合，即 $S = \{n_1 \cdot a_1, n_2 \cdot a_2, \cdots, n_k \cdot a_k\}$ ，为有 $n_1$ 个 $a_1$ ， $n_2$ 个 $a_2$ ， $\cdots$， $n_k$ 个 $a_k$ 。

##### 多重集的排列数

- **多重集的排列数**相当于把相同元素的排列数除掉了。具体地，你可以认为你有 $k$ 种不一样的球，每种球的个数为 $n_1 \sim n_k$ ，且 $n_1 + n_2 + \cdots + n_k = n$ 。这 $n$ 个球的全排列数就是**多重集的排列数**：
  $$
  {n \choose {n_1,n_2,\cdots,c_k}} = \frac{n!}{\prod_{i=1}^{k}n_i!}
  $$

##### 多重集的组合数

> **问题**：要求从多重集中取 $r$ 个元素组成新的多重集，一共有多少种取法？

- 显然转换成 $x_1 + x_2 + \cdots + x_k = r$：

  1. 如果有限制 $r \leq \min n_i$ ，那么很简单只要用插板法：
     $$
     {r+k-1 \choose k-1}
     $$

  2. 如果不加限制，则（我懒得自己推一遍，直接给答案）：
     $$
     \sum_{p=0}^{k}(-1)^p\sum_A {k+r-1 -\sum_AnA_i -p \choose k-1}
     $$
     其中 $A$ 是充当枚举子集的作用，满足 $|A| = p, A_i < A_{i+1}$ 。

#### 其他

- **见**：https://oi-wiki.org/math/combinatorics/combination/#%E7%BB%84%E5%90%88%E6%95%B0%E6%80%A7%E8%B4%A8--%E4%BA%8C%E9%A1%B9%E5%BC%8F%E6%8E%A8%E8%AE%BA